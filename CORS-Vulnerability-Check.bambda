id: d55f0de5-fb3a-4f51-a4b4-b8d2637d127c
name: CORS-Vulnerability-Check
function: CUSTOM_ACTION
location: REPEATER
source: |-
  var req = requestResponse.request();
  var new_req = req.withAddedHeader("Origin","https://baidu.com");
  var res = api().http().sendRequest(new_req);
  if (res.response().hasHeader("Access-Control-Allow-Origin")){
      	logging().logToOutput(res.response().header("Access-Control-Allow-Origin"));
      
      	if (res.response().hasHeader("Access-Control-Allow-Credentials")){
      			logging().logToOutput(res.response().header("Access-Control-Allow-Credentials"));
      		}else{
          	}
      }else{
      	res.response().headers().forEach((i)->{
          	logging().logToOutput(i);
          });
      	logging().logToOutput("\n!!!Origin Parameter Not Find.!!!");
      }
